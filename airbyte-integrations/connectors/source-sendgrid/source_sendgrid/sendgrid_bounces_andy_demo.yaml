limit: 10

constant_retrier:
  backoff_strategies:
    - type: "ConstantBackoffStrategy"
      backoff_time_in_seconds: 2

lists_stream:
  options:
    name: "bounces"
    primary_key: email
    cursor_field: "created"
    url_base: "https://api.sendgrid.com"
    schema_loader:
      file_path: "./source_sendgrid/schemas/{{name}}.json"
    checkpoint_interval: 1
    retriever:
      paginator:
        type: "LimitPaginator"
        limit_value: "*ref(limit)"
        limit_option:
          option_type: "request_parameter"
          field_name: "limit"
        page_token_option:
          option_type: "request_parameter"
          field_name: "offset"
        pagination_strategy:
          type: "OffsetIncrement"
      requester:
        error_handler: "*ref(constant_retrier)"
        path: "v3/suppression/bounces"
        authenticator:
          type: "TokenAuthenticator"
          token: "{{ config.apikey }}"
      record_selector:
        extractor:
          transform: "_"
      stream_slicer:
        type: "DatetimeStreamSlicer"
        start_datetime: "2017-01-01T00:00:00.0Z"
        end_datetime: "2022-01-01T00:00:00.0Z"
        step: "1000d"
        cursor_field: "created"
        start_time_option:
          field_name: "start_time"
          option_type: "request_parameter"
        datetime_format: "timestamp"
streams:
  - "*ref(lists_stream)"
check:
  stream_names:
    - "bounces"
